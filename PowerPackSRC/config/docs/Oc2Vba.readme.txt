oc2vba.dll
Плагин для ОпенКонфа для сопряжения его с VBA
Автор: Александр Орефков. orefkov@ezmail.ru

Описание.

При написании скриптов для ОпенКонфа одна из сложностей, это организация
взаимодействия скрипта с пользователем.
Кроме InputBox в VBScript практически никаких других возможностей для
ввода информации нет.
Еще одна сложность, написание самих скриптов. Хочется иметь и IntelliSence,
и просмотр объектной модели ОпенКонфа.

Этих недостатков нет в среде VBA, которая к тому же многим знакома и привычна.
Итак, можно ли использовать VBA для работы с ОпенКонфом?
Теперь да. С небольшой оговоркой.
Для интеграции VBA со своим приложением MicroSoft предлагает использовать
тн "Application Programmability Components" (APC), входящий в "VBA SDK".
Для распространения дистрибутива VBA и APC со своим приложением
необходимо получить лицензию от MS.
Стоимость лицензии не разглашается и определяется индивидуально.

Так как проходить подобную процедуру мне не улыбается, то дистрибутив VBA и APC
я распространять не могу. Но если у вас уже установлено какое-либо приложение,
интегрированное с VBA (кроме Офиса), то все необходимое для работы у вас уже есть.

Как проверить, установлен ли у вас APC и VBA?
Посмотрите папку
"Program Files\Common Files\Microsoft Shared\VBA\VBA6"
Если в ней есть файл apc60.dll или apc63.dll, значит, плагин у вас заработает.
Из приложений, устанавливающих VBA, навскидку назову Visio 2000, AutoCAD,
Corel Draw 10.
Лично я нашел отдельный пакет для установки VBA с APC в дистрибутиве Visio 2000.

Документацию по интеграции VBA со своим приложением я не нашел.
Только несколько начальных примеров на VB. Поэтому все сделано методом
научного тыка, но вроде работает.

Итак, если VBA и APC у вас уже установленны, то можно начинать использовать
плагин. Как обычно, разместите его в bin\config
При загрузке плагин создаст подключение к среде VBA и пытается загрузить
VBA-проекты по умолчанию. Это файлы openconf.ocp в каталоге ИБ и в
каталоге bin. Если таких проектов не найдено, плагин создаст пустой проект,
который затем можно будет сохранить в любой файл.
Далее, если в проекте есть макрос с именем main, плагин запустит его.

Использование плагина.
Плагин предоставляет три макроса, которые можно вызвать через меню
"OpenConf-макросы", или непосредственно с закладки "OpenConf".
Это:
OpenIDE - открыть окно среды разработки VBA
OpenProject - загрузить VBA проект из файла.
ShowMacrosDialog - вызвать окно "Макросы" 

Также у плагина из скриптов доступны следующие методы и свойства:
метод ShowIDE(boolean Show) - позволяет отобразить/скрыть среду VBA IDE
метод LoadProject(FilePath As String) - загрузить проект из указанного файла.

свойство APC As MSAPC.APC
свойство APCGlobal As MSAPC.APCGlobal
подробнее о них можно узнать из библиотеки типов, хранящейся в apc60.dll



Также в дистрибутив входит пример проекта на VBA, openconf.ocp
Расположите его в bin
В примере показывается, как подключится к событиям Конфигуратора,
а также пример работы с формой VBA, демонстрирующий
"продвинутую" вставку текста формирования новой колонки тз.

С уважением, Александр Орефков.