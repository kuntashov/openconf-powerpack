===========================================================================
(c) 2004 Alexander Kuntashov
===========================================================================
—крипт:  navigator.js ("Ќавигатор")
¬ерси€:  1.2
јвтор:   јлександр  унташов
E-mail:  kuntashov at yandex dot ru
ICQ UIN: 338758861
===========================================================================

—одержание 
~~~~~~~~~~
    
    ќписание 
    “ребовани€
    ”становка
    ћакросы

ќписание
~~~~~~~~

    —крипт "Ќавигатор" дл€ OpenConf предназначен дл€ быстрого доступа к объектам
матаданных конфигурации или объектам файловой системы, задаваемых в тексте модул€
полным (абсолютным) или относительным (только дл€ путей файловой системы) путем. 

    ѕри запуске одного из доступных макросов скрипта, он анализирует сроку под курсором
как путь и пытаетс€ его открыть.

    ≈сли выделить часть строки, и вызвать один из макросов, то в качестве пути 
будет вз€то содержимое выделени€ - это позвол€ет открывать часть пути (удобно
дл€ открыти€ внешних файлов, например, когда надо открыть не сам файл, а каталог,
в котором он находитс€), а также решает проблему с пут€ми, которые содержат пробелы.

    “акже скрипт позвол€ет переходить из редактируемого модул€ или диалога формы объекта 
к модулю или диалогу любой другой доступной дл€ данного объекта формы. Ќапример, из модул€ 
формы документа можно быстро перейти к модулю проведени€ этого документа и наоборот,
из модул€ проведени€ - к форме документа (к диалогу или модулю).

ќписани€ макросов скрипта см. ниже.

“ребовани€ 
~~~~~~~~~~

    - OpenConf версии не ниже 1.0.1.6 (http://openconf.itland.ru/beta)
    - Svcsvc.dll јлександра ќрефкова (брать там же, http://openconf.itland.ru/beta)   

”становка        
~~~~~~~~~

    1. ѕредполагаетс€, что у вас уже установлен OpenConf и компонента Svcsvc.dll; 
        если нет, то инструкции по их установке можно найти в соответствующих 
        readme-файлах, которые наход€тс€ в архивах OpenConf'a и Svcsvc.dll

    2. —копируйте скрипт navigator.js в папку 
            < аталог1C>/BIN/config/scripts/,
        где  аталог1— - каталог, в который установлена 1—
 
    3. (ѕере)запустите конфигуратор; рекомендую дл€ удобства использовани€
        назначить на соответствующие макросы гор€чие клавиши (√лавное меню ->
        OpenConf->ћакросы-> лавиатура...); € пользуюсь следующими сочетани€ми
        клавиш:
                        ћакрос                       лавиатурное сочетание
        
            ќткрытьћодульƒл€ќбъектаѕод урсором          Ctrl+Shift+M        
            ќткрыть‘ормуƒл€ќбъектаѕод урсором           Ctrl+Shift+F
            ќткрытьƒругойћодульƒл€“екущегоќбъекта       Alt+Shift+M
            ќткрытьƒругую‘ормуƒл€“екущегоќбъекта        Alt+Shift+F

ћакросы
~~~~~~~

—оответствующие функции скрипта доступны через следующие макросы:

    ќткрытьћодульƒл€ќбъектаѕод урсором
        ƒл€ слова или пути под курсором производитс€ попытка открыть его модуль,
        если такой объект метаданных существует. 
        ≈сли у объекта несколько модулей, (например, у документа есть модуль формы 
        и модуль проведени€, у справочников, свой модуль у каждой формы - формы 
        группы, элемента, списка...), то пользователю предлагаетс€ выбрать из списка, 
        какой модуль открыть. 
        ƒл€ внешних файлов, если это не внешний отчет или обработка, просто производитс€ 
        попытка открыть  файл - если это возможно (дл€ файлов с расширени€ми *.mxl, 
        *.txt, *.1S, *.1C) внутри конфигуратора, если нет - то производитс€ попытка 
        открыть этот файл с помощью программы, назначенной дл€ открыти€ файлов этого типа.

    ќткрыть‘ормуƒл€ќбъектаѕод урсором    
        јналогичто макросу ќткрытьћодульƒл€ќбъектаѕод урсором открывает одну из форм
        объекта. ƒл€ внешних файлов, не €вл€ющихс€ внешними отчетами или обработками
        действи€ макроса повтор€ют действи€м макроса ќткрытьћодульƒл€ќбъектаѕод урсором.

    ќткрытьƒругойћодульƒл€“екущегоќбъекта
        ≈сли вы редактируете модуль или диалог документа, справочника или журнала
        документов, то вы можете открыть любой другой его модуль или форму с помощью
        этого макроса. Ќапример, из модул€ формы документа вы сможете открыть его
        модуль проведени€ и наоборот; аналогично дл€ справочников и журналов документов - 
        редактиру€ модуль или диалог одной из форм справочника или журнала вы можете легко 
        перейти в модуль другой формы этого справочника или журнала документов.

    ќткрытьƒругую‘ормуƒл€“екущегоќбъекта 
        ƒействи€ аналогичны действи€м макроса ќткрытьƒругойћодульƒл€“екущегоќбъекта, только
        открываетс€ не модуль, а редактор диалога соответствующей формы.


-----------------------------------------------------------------------------

ѕримеры путей, которые открывает "Ќавигатор":
                    
    —оздатьќбъект("—правочник.Ќоменклатура");  (курсор должен быть внутри строки "...")
    —правочник. онтрагенты.‘орма—писка
    ќткрыть‘орму("Ёлемент. онтрагенты"); (курсор должен быть внутри строки "...")
    
    ќтчет.јнализ—убконто
    ќбработка.ќбработкаƒокументов  
    
    ƒокумент.¬ыписка     
    
    ∆урнал.ѕлатежныеƒокументы.‘орма—писка
    ∆урнал.ѕлатежныеƒокументы.ƒл€ѕодбора
    ∆урнал.ѕодчиненные
    
    ∆урнал–асчетов.Ќовый1
    ∆урнал–асчетов.Ќовый1.‘орма2    
    
    —чет.ќсновной
    ѕлан—четов.ќсновной.ќсновна€
    
    —оздатьќбъект("ќпераци€"); (курсор должен быть внутри строки "...")      
    
    блаќпераци€ (если выделить слово "ќпераци€", то откроет форму операции)
    
    ∆урналќпераций.‘орма—писка
    
    ∆урналѕроводок.ќсновной
    ∆урналѕроводок.ƒл€ќпераций    
    
    D:\home\KuntashovAM\Projects\oconf\docs\names.txt  (откроет внутри конфигуратора)
    
    D:\home\KuntashovAM\Projects\oconf\docs\form.zip  (откроет внешним архиватором)
    
    D:\home\KuntashovAM\Projects\oconf\docs\OpenConf.chm   
    
    D:\temp\bazopuzo.ert    (откроет внутри конфигуратора) 
    
    D:\temp\test.1c   (откроет внутри конфигуратора)
    
    D:\home\KuntashovAM\Bases77\ConvData\ExtForms\CDExport.ert   (откроет внутри конфигуратора)
    
    \\SVETLANA\ѕЅќёЋ\ExtForms\PrnForms\1cbd.mxl  (откроет внутри конфигуратора)
    
    .\ExtForms\HKeys.ert       (откроет внутри конфигуратора)
    
    .\ExtForms\CDExport.ert  (откроет внутри конфигуратора)
    
    ..\readme.txt      (откроет внутри конфигуратора)
    
    ..\..\ConvData\ExtForms\CDExport.ert (откроет внутри конфигуратора)  
    
    ..\..\ConvData\ExtForms\   (откроет в ѕроводнике)

„то бы открыть папку или путь содержащий пробелы, его нужно предварительно выделить
    C:\Program Files\1Cv77.Adm\BIN\Config\scripts\

